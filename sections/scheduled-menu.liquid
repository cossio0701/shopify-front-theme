{%- comment -%}
  Scheduled Menu Section
  Renders a menu with items that can be scheduled to show/hide based on dates.
  Items are managed via blocks in the theme customizer.
{%- endcomment -%}

{%- liquid
  assign menu_items = ''
-%}

{%- for block in section.blocks -%}
  {%- assign label = block.settings.menu_label -%}
  {%- assign url = block.settings.menu_url -%}
  {%- assign start_date = block.settings.start_date -%}
  {%- assign end_date = block.settings.end_date -%}

  {%- capture visible_string -%}
    {%- render 'date-visibility', start_date: start_date, end_date: end_date -%}
  {%- endcapture -%}
  {%- if visible_string == 'true' -%}
    {%- assign visible = true -%}
  {%- else -%}
    {%- assign visible = false -%}
  {%- endif -%}

  {%- if visible and label != blank and url != blank -%}
    {%- assign item_html = '<li><a href="' | append: url | append: '">' | append: label | append: '</a></li>' -%}
    {%- assign menu_items = menu_items | append: item_html -%}
  {%- endif -%}
{%- endfor -%}{%- if menu_items != blank -%}
  <nav class="scheduled-menu">
    <ul class="scheduled-menu__list">
      {{ menu_items }}
    </ul>
  </nav>
{%- endif -%}

{%- schema -%}
{
  "name": "Scheduled Menu",
  "blocks": [
    {
      "type": "menu_item",
      "name": "Menu Item",
      "settings": [
        {
          "type": "text",
          "id": "menu_label",
          "label": "Texto del menú"
        },
        {
          "type": "url",
          "id": "menu_url",
          "label": "URL"
        },
        {
          "type": "text",
          "id": "start_date",
          "label": "Fecha inicial (optional)",
          "info": "Format: YYYY-MM-DD HH:MM (e.g., 2025-10-01 14:30)"
        },
        {
          "type": "text",
          "id": "end_date",
          "label": "Fecha final (optional)",
          "info": "Format: YYYY-MM-DD HH:MM (e.g., 2025-10-31 23:59)"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Configuración del menú"
    }
  ]
}
{%- endschema -%}
